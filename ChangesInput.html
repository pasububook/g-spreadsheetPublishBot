<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body {
        font-family: sans-serif;
        padding: 15px;
        background-color: #f5f5f5;
      }
      textarea {
        width: 100%;
        height: 150px;
        box-sizing: border-box;
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 10px;
        font-size: 14px;
        resize: vertical;
      }
      .button-container {
        text-align: right;
        margin-top: 10px;
      }
      button {
        background-color: #4CAF50;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
      }
      button:hover {
        background-color: #45a049;
      }
      #status {
        margin-top: 10px;
        color: #555;
      }
    </style>
  </head>
  <body>
    <p>変更内容を複数行で記述できます。</p>
    <textarea id="changesInput" placeholder="例: 
- 新機能の追加
- レイアウトの調整
- バグの修正"></textarea>
    <div class="button-container">
      <button onclick="sendChanges()">出版</button>
      <button onclick="google.script.host.close()">キャンセル</button>
    </div>
    <div id="status"></div>
    <script>
      function sendChanges() {
        const changes = document.getElementById('changesInput').value;
        const statusDiv = document.getElementById('status');
        
        // Google Apps Scriptの関数を呼び出してデータを渡す
        google.script.run
          .withSuccessHandler(function() {
            statusDiv.textContent = '送信中です...';
            google.script.host.close(); // 成功したらダイアログを閉じる
          })
          .withFailureHandler(function(error) {
            statusDiv.textContent = 'エラーが発生しました: ' + error.message;
          })
          .processAndSend(changes);
      }
    </script>
  </body>
</html>
